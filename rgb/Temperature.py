
from matplotlib.colors import LinearSegmentedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in pycam02ucs.cm.viscm
parameters = {'xp': [-9.267418289595696, -15.419196618793364, 0.14118386094193625, 34.51876864175253, 57.316535391132192, -13.177526160889443],
              'yp': [-11.962365591397827, -42.721257237386254, -45.616211745243987, -4.0012406947890611, 39.784946236559165, 33.24340527577937],
              'min_JK': 15.0,
              'max_JK': 95.0}

cm_data = [[ 0.04302358,  0.13474665,  0.18140337],
       [ 0.04240897,  0.13792073,  0.18800001],
       [ 0.04165999,  0.14107641,  0.1946946 ],
       [ 0.04077187,  0.14421282,  0.20148975],
       [ 0.0397311 ,  0.14732901,  0.20838816],
       [ 0.03855143,  0.15042392,  0.21539255],
       [ 0.03724105,  0.1534964 ,  0.22250568],
       [ 0.03580285,  0.15654515,  0.22973032],
       [ 0.03424087,  0.15956878,  0.23706925],
       [ 0.03256045,  0.16256574,  0.24452524],
       [ 0.03076847,  0.16553433,  0.25210098],
       [ 0.02887354,  0.16847269,  0.2597991 ],
       [ 0.02688628,  0.1713788 ,  0.26762207],
       [ 0.02481959,  0.17425043,  0.27557218],
       [ 0.02268901,  0.17708515,  0.28365145],
       [ 0.02051306,  0.17988032,  0.29186156],
       [ 0.0183137 ,  0.18263309,  0.30020374],
       [ 0.01611679,  0.18534035,  0.30867865],
       [ 0.01394963,  0.18799857,  0.31728913],
       [ 0.01183182,  0.19060305,  0.32605043],
       [ 0.00982138,  0.19315054,  0.33494519],
       [ 0.00796646,  0.19563678,  0.3439702 ],
       [ 0.00631393,  0.19805632,  0.35313086],
       [ 0.0049157 ,  0.20040227,  0.36243808],
       [ 0.00386801,  0.20267147,  0.37185852],
       [ 0.00323444,  0.20485433,  0.3814143 ],
       [ 0.00313014,  0.20694652,  0.39107272],
       [ 0.00365946,  0.20893787,  0.40084031],
       [ 0.00496882,  0.21082444,  0.41067256],
       [ 0.00720225,  0.21259237,  0.42057984],
       [ 0.01054921,  0.21423793,  0.43050305],
       [ 0.01521325,  0.21575377,  0.44039987],
       [ 0.02142405,  0.21713384,  0.4502151 ],
       [ 0.02943238,  0.21837553,  0.45987412],
       [ 0.03949632,  0.21948176,  0.46928092],
       [ 0.05086063,  0.22046312,  0.47831933],
       [ 0.06257574,  0.22133954,  0.48685917],
       [ 0.07454043,  0.22213965,  0.49477008],
       [ 0.08661527,  0.22290298,  0.50192957],
       [ 0.09865147,  0.22367341,  0.5082488 ],
       [ 0.1105096 ,  0.22449282,  0.51368648],
       [ 0.12207582,  0.22539556,  0.51825135],
       [ 0.13327698,  0.22640372,  0.52199428],
       [ 0.14407016,  0.22752953,  0.52499182],
       [ 0.15444014,  0.22877623,  0.52733343],
       [ 0.16439265,  0.23014034,  0.5291105 ],
       [ 0.17394739,  0.23161402,  0.53040901],
       [ 0.18313202,  0.23318705,  0.53130567],
       [ 0.19197774,  0.23484833,  0.53186658],
       [ 0.20051629,  0.2365868 ,  0.5321475 ],
       [ 0.20877579,  0.23839253,  0.53219616],
       [ 0.21676523,  0.24026007,  0.5320632 ],
       [ 0.22453073,  0.24217645,  0.5317705 ],
       [ 0.23207736,  0.24413789,  0.53135732],
       [ 0.23943473,  0.24613581,  0.53084126],
       [ 0.24661062,  0.24816661,  0.53025025],
       [ 0.25363309,  0.25022275,  0.52959177],
       [ 0.2604972 ,  0.2523039 ,  0.52889678],
       [ 0.26723301,  0.25440265,  0.52816277],
       [ 0.27384587,  0.25651696,  0.52740556],
       [ 0.28033883,  0.25864552,  0.52664149],
       [ 0.28673094,  0.26078372,  0.52586875],
       [ 0.29302942,  0.26292961,  0.52509494],
       [ 0.29923645,  0.26508244,  0.52433159],
       [ 0.30536002,  0.26724029,  0.52358272],
       [ 0.31141027,  0.26940082,  0.5228483 ],
       [ 0.31739271,  0.27156274,  0.52213223],
       [ 0.32331252,  0.27372489,  0.52143774],
       [ 0.32917463,  0.27588619,  0.52076748],
       [ 0.33498108,  0.27804628,  0.52012679],
       [ 0.34073843,  0.28020373,  0.51951484],
       [ 0.34645197,  0.28235741,  0.51893155],
       [ 0.35212565,  0.28450649,  0.51837789],
       [ 0.35776326,  0.28665021,  0.51785451],
       [ 0.36336842,  0.2887878 ,  0.51736175],
       [ 0.36894463,  0.29091855,  0.5168997 ],
       [ 0.37449523,  0.29304175,  0.51646817],
       [ 0.38002347,  0.29515671,  0.51606677],
       [ 0.38553247,  0.29726276,  0.5156949 ],
       [ 0.39102524,  0.29935923,  0.51535175],
       [ 0.39650471,  0.30144547,  0.51503633],
       [ 0.4019737 ,  0.30352084,  0.51474747],
       [ 0.40743494,  0.30558469,  0.51448383],
       [ 0.41289107,  0.3076364 ,  0.51424393],
       [ 0.41834467,  0.30967534,  0.51402611],
       [ 0.4237982 ,  0.31170091,  0.51382858],
       [ 0.42925407,  0.31371251,  0.5136494 ],
       [ 0.43471457,  0.31570955,  0.51348649],
       [ 0.44018193,  0.31769146,  0.51333766],
       [ 0.44565829,  0.31965769,  0.51320058],
       [ 0.4511457 ,  0.32160769,  0.51307278],
       [ 0.4566461 ,  0.32354096,  0.5129517 ],
       [ 0.46216135,  0.32545701,  0.51283466],
       [ 0.46769322,  0.32735538,  0.51271888],
       [ 0.47324286,  0.32923584,  0.51260213],
       [ 0.4788119 ,  0.33109799,  0.51248135],
       [ 0.48440227,  0.33294126,  0.51235286],
       [ 0.49001531,  0.33476534,  0.51221356],
       [ 0.49565224,  0.33656996,  0.51206026],
       [ 0.50131419,  0.33835488,  0.51188974],
       [ 0.50700212,  0.34011991,  0.51169872],
       [ 0.5127169 ,  0.34186492,  0.5114839 ],
       [ 0.51845928,  0.34358983,  0.51124199],
       [ 0.52422987,  0.34529461,  0.51096965],
       [ 0.53002908,  0.34697931,  0.51066367],
       [ 0.53585682,  0.34864423,  0.51032137],
       [ 0.54171402,  0.3502892 ,  0.50993861],
       [ 0.5476008 ,  0.35191441,  0.50951214],
       [ 0.55351718,  0.3535201 ,  0.50903878],
       [ 0.55946305,  0.35510656,  0.50851541],
       [ 0.5654382 ,  0.35667416,  0.50793896],
       [ 0.5714423 ,  0.35822331,  0.50730646],
       [ 0.57747492,  0.35975447,  0.50661502],
       [ 0.58353549,  0.36126818,  0.50586186],
       [ 0.58962348,  0.36276496,  0.50504418],
       [ 0.59573828,  0.36424538,  0.50415919],
       [ 0.6018791 ,  0.3657101 ,  0.50320439],
       [ 0.60804504,  0.36715985,  0.50217739],
       [ 0.61423516,  0.3685954 ,  0.50107589],
       [ 0.6204484 ,  0.37001755,  0.49989774],
       [ 0.62668368,  0.37142718,  0.49864088],
       [ 0.63293982,  0.37282519,  0.49730336],
       [ 0.63921604,  0.37421231,  0.49588267],
       [ 0.64551091,  0.37558961,  0.4943773 ],
       [ 0.65182296,  0.37695822,  0.49278583],
       [ 0.65815078,  0.37831922,  0.49110677],
       [ 0.66449292,  0.37967378,  0.48933872],
       [ 0.6708479 ,  0.38102309,  0.48748039],
       [ 0.67721417,  0.3823684 ,  0.48553057],
       [ 0.68359013,  0.38371101,  0.48348818],
       [ 0.68997413,  0.3850523 ,  0.48135221],
       [ 0.69636475,  0.38639354,  0.47912125],
       [ 0.70276077,  0.38773591,  0.47679346],
       [ 0.70915965,  0.38908138,  0.4743694 ],
       [ 0.71555951,  0.39043158,  0.47184844],
       [ 0.72195842,  0.39178822,  0.46923003],
       [ 0.72835437,  0.3931531 ,  0.46651371],
       [ 0.73474527,  0.39452811,  0.46369911],
       [ 0.74112897,  0.39591522,  0.46078594],
       [ 0.74750322,  0.39731651,  0.45777401],
       [ 0.75386569,  0.39873416,  0.45466324],
       [ 0.76021396,  0.40017048,  0.45145362],
       [ 0.76654547,  0.40162787,  0.44814528],
       [ 0.77285759,  0.40310889,  0.44473845],
       [ 0.77914754,  0.40461621,  0.44123349],
       [ 0.78541241,  0.40615267,  0.4376309 ],
       [ 0.79164963,  0.40772096,  0.43393006],
       [ 0.79785548,  0.4093245 ,  0.4301331 ],
       [ 0.80402655,  0.41096663,  0.42624121],
       [ 0.8101593 ,  0.4126508 ,  0.42225564],
       [ 0.81625003,  0.41438064,  0.41817791],
       [ 0.82229484,  0.41615996,  0.41400975],
       [ 0.82828964,  0.41799273,  0.40975321],
       [ 0.83423015,  0.41988311,  0.40541066],
       [ 0.84011188,  0.42183542,  0.4009848 ],
       [ 0.84593016,  0.42385413,  0.39647873],
       [ 0.8516801 ,  0.42594387,  0.39189597],
       [ 0.85735661,  0.42810941,  0.38724049],
       [ 0.86295442,  0.43035562,  0.38251678],
       [ 0.86846828,  0.4326874 ,  0.37772896],
       [ 0.87389249,  0.43510983,  0.37288287],
       [ 0.87922118,  0.43762801,  0.3679854 ],
       [ 0.8844485 ,  0.44024696,  0.36304349],
       [ 0.88956856,  0.44297164,  0.35806476],
       [ 0.89457545,  0.44580685,  0.35305749],
       [ 0.89946331,  0.44875717,  0.34803068],
       [ 0.90422639,  0.45182693,  0.34299401],
       [ 0.90885912,  0.45502011,  0.3379578 ],
       [ 0.91335617,  0.45834024,  0.33293303],
       [ 0.91771254,  0.46179038,  0.32793122],
       [ 0.92192363,  0.46537302,  0.32296439],
       [ 0.92598531,  0.46909   ,  0.318045  ],
       [ 0.92989402,  0.4729425 ,  0.31318579],
       [ 0.93364678,  0.47693095,  0.30839969],
       [ 0.9372413 ,  0.48105505,  0.30369969],
       [ 0.94067619,  0.48531338,  0.29910081],
       [ 0.94395055,  0.48970426,  0.29461421],
       [ 0.94706425,  0.49422517,  0.29025178],
       [ 0.95001788,  0.4988729 ,  0.28602509],
       [ 0.95281267,  0.50364366,  0.28194501],
       [ 0.95545052,  0.50853314,  0.27802168],
       [ 0.95793383,  0.51353659,  0.27426436],
       [ 0.96026554,  0.51864895,  0.27068138],
       [ 0.96244894,  0.52386491,  0.26728013],
       [ 0.96448765,  0.52917905,  0.26406696],
       [ 0.96638549,  0.53458588,  0.26104727],
       [ 0.96814641,  0.54007998,  0.25822545],
       [ 0.96977811,  0.54565263,  0.25561279],
       [ 0.97128268,  0.5513006 ,  0.25320635],
       [ 0.97266402,  0.55701906,  0.25100732],
       [ 0.97392605,  0.56280327,  0.24901656],
       [ 0.97507245,  0.56864883,  0.24723418],
       [ 0.97610663,  0.57455169,  0.24565964],
       [ 0.97703165,  0.58050819,  0.24429182],
       [ 0.97785428,  0.5865118 ,  0.24313394],
       [ 0.97858717,  0.59255162,  0.24219434],
       [ 0.97922156,  0.59863398,  0.24145607],
       [ 0.97975925,  0.60475662,  0.24091613],
       [ 0.98020164,  0.6109176 ,  0.2405713 ],
       [ 0.98056766,  0.61710207,  0.24043275],
       [ 0.98085422,  0.62331206,  0.24049076],
       [ 0.98105171,  0.62955403,  0.24073263],
       [ 0.98116016,  0.63582723,  0.24115443],
       [ 0.98121619,  0.64210545,  0.2417737 ],
       [ 0.98119004,  0.64840941,  0.24256562],
       [ 0.98107759,  0.65474129,  0.24352402],
       [ 0.98091219,  0.66107822,  0.24466021],
       [ 0.98067752,  0.66743111,  0.24596007],
       [ 0.98035694,  0.67381041,  0.24741239],
       [ 0.9799948 ,  0.68018721,  0.24902844],
       [ 0.97956084,  0.68658093,  0.25079157],
       [ 0.97904379,  0.69299815,  0.2526945 ],
       [ 0.97850255,  0.69940236,  0.25474731],
       [ 0.97787318,  0.70583278,  0.25692885],
       [ 0.97719384,  0.71226602,  0.25924294],
       [ 0.97646086,  0.71870438,  0.26168326],
       [ 0.97564505,  0.72516473,  0.264241  ],
       [ 0.97481159,  0.73160937,  0.26691947],
       [ 0.97388309,  0.73808257,  0.26970528],
       [ 0.97293322,  0.74454267,  0.27260041],
       [ 0.97190338,  0.7510224 ,  0.27559594],
       [ 0.97083217,  0.75750041,  0.27868958],
       [ 0.96970147,  0.76398661,  0.28187608],
       [ 0.96851343,  0.77047977,  0.28515135],
       [ 0.96728136,  0.77697293,  0.28851098],
       [ 0.96598052,  0.78347893,  0.29195129],
       [ 0.96464559,  0.78998   ,  0.29546714],
       [ 0.96323545,  0.79649699,  0.2990563 ],
       [ 0.96179522,  0.80300734,  0.30271248],
       [ 0.96027869,  0.80953389,  0.3064348 ],
       [ 0.95872971,  0.81605525,  0.31021638],
       [ 0.95710906,  0.82259035,  0.31405676],
       [ 0.95544688,  0.82912481,  0.31794977],
       [ 0.95372369,  0.83566783,  0.3218938 ],
       [ 0.95194281,  0.84221778,  0.3258852 ],
       [ 0.95011791,  0.84876847,  0.32991915],
       [ 0.94821173,  0.85533657,  0.33399676],
       [ 0.94628515,  0.86189504,  0.33810767],
       [ 0.94424591,  0.86848423,  0.34226014],
       [ 0.94221678,  0.87505093,  0.34643582],
       [ 0.94006662,  0.88165131,  0.35064851],
       [ 0.93790202,  0.88824009,  0.35488163],
       [ 0.93564594,  0.89484947,  0.35914252],
       [ 0.93332774,  0.90146702,  0.36342467],
       [ 0.93096248,  0.90808662,  0.36772349],
       [ 0.9284783 ,  0.91473673,  0.37204599],
       [ 0.92599947,  0.92136803,  0.37637331],
       [ 0.92338916,  0.92803401,  0.3807211 ],
       [ 0.92073734,  0.93469943,  0.38507529],
       [ 0.91800447,  0.94137933,  0.38943884],
       [ 0.91515352,  0.94808701,  0.39381418],
       [ 0.91229058,  0.95478291,  0.39818604],
       [ 0.90928341,  0.96151527,  0.40256873],
       [ 0.90622019,  0.96825152,  0.40694958],
       [ 0.90306896,  0.9750029 ,  0.41133063],
       [ 0.89976225,  0.98179231,  0.41571757]]

test_cm = LinearSegmentedColormap.from_list(__file__, cm_data)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from pycam02ucs.cm.viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("pycam02ucs not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
